<div class="page-container">
  <p-button
    label="Voltar"
    icon="pi pi-arrow-left"
    (click)="navigationService.goToDashboard()"
    styleClass="p-button-text p-button-secondary"
  >
  </p-button>

  <div *ngIf="isLoading" class="spinner-container">
    <p-progressSpinner></p-progressSpinner>
  </div>

  <div *ngIf="!isLoading && user">
    <div class="header">
      <h1 class="font-logo">Meu Perfil</h1>
      <p>Aqui estão os seus dados e o seu progresso.</p>
    </div>

    <div class="profile-grid">
      <p-card header="Detalhes da Conta" styleClass="user-details-card">
        <div class="detail-item">
          <span class="detail-label">Nome</span>
          <span class="detail-value">{{ user.name }}</span>
        </div>
        <div class="detail-item">
          <span class="detail-label">Email</span>
          <span class="detail-value">{{ user.email }}</span>
        </div>
        <div class="detail-item">
          <span class="detail-label">Altura</span>
          <span class="detail-value"
            >{{ user.height || "Não informado" }} cm</span
          >
        </div>
        <div class="detail-item">
          <span class="detail-label">Peso</span>
          <span class="detail-value"
            >{{ user.weight || "Não informado" }} kg</span
          >
        </div>
        <div class="detail-item">
          <span class="detail-label">Objetivo</span>
          <span class="detail-value">{{ user.goal || "Não informado" }}</span>
        </div>
      </p-card>

      <p-card header="Minhas Conquistas" styleClass="achievements-card">
        <div class="empty-state">
          <i class="pi pi-shield icon"></i>
          <p>As suas conquistas aparecerão aqui em breve!</p>
        </div>
      </p-card>
    </div>

    <p-divider></p-divider>

    <div class="history-section">
      <h2 class="font-logo">Histórico de Treinos</h2>

      <div
        *ngIf="workoutHistory.length > 0; else noHistory"
        class="history-list"
      >
        <a
          *ngFor="let log of workoutHistory"
          [routerLink]="['/session', log.id, 'summary']"
          class="history-card"
        >
          <div class="card-header">
            <i class="pi pi-calendar-check icon"></i>
            <span class="date">{{
              log.completedAt | date : "dd/MM/yyyy"
            }}</span>
          </div>
          <div class="card-body">
            <h3 class="workout-name">{{ log.workoutName }}</h3>
            <div class="stats">
              <span
                ><i class="pi pi-clock"></i>
                {{ log.durationMinutes || 0 }} min</span
              >
              <span
                ><i class="pi pi-bolt"></i> {{ log.totalVolume || 0 }} kg</span
              >
            </div>
          </div>
          <div class="card-footer">
            <span>Ver Detalhes <i class="pi pi-arrow-right"></i></span>
          </div>
        </a>
      </div>

      <ng-template #noHistory>
        <div class="empty-state">
          <i class="pi pi-history icon"></i>
          <p>
            Você ainda não concluiu nenhum treino. O seu histórico aparecerá
            aqui!
          </p>
        </div>
      </ng-template>
    </div>
  </div>
</div>
